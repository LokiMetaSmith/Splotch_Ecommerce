<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Image Editor & Secure Pay - Custom Stickers</title>
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="icon" href="/favicon.png" type="image/png" />
    <link rel="apple-touch-icon" href="/favicon192.png" />
    <!-- SVG.js (if still needed, though not directly used by core image editing) -->
    <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.js@3.0/dist/svg.min.js"></script>
    <!-- Square Web Payments SDK -->
    <script
      type="text/javascript"
      src="https://sandbox.web.squarecdn.com/v1/square.js"
    ></script>
    <!-- Clipper.js for SVG offsetting -->
    <script src="/lib/clipper.js"></script>
    <link rel="stylesheet" href="./styles.css" />
    <!-- Your Tailwind CSS -->
    <link rel="stylesheet" href="./splotch-theme.css" />
    <!-- Your Splotch Theme CSS -->
    <style>
      .size-btn {
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        background-color: #f3f4f6;
        border: 1px solid #d1d5db;
        transition: background-color 0.2s;
        cursor: pointer;
      }
      .size-btn:hover {
        background-color: #e5e7eb;
      }
      .size-btn:focus-visible {
        outline: 2px solid #2563eb;
        outline-offset: 2px;
        background-color: #e5e7eb;
      }
      /* Top Menu Bar CSS */
      .top-menu-bar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        padding: 1rem;
        display: flex;
        justify-content: space-between;
        pointer-events: none;
        z-index: 9999;
      }
      .menu-item {
        pointer-events: auto;
        background: #2a284d; /* splotch-navy fallback */
        background: var(--splotch-navy, #2a284d);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 9999px;
        font-family: var(--font-baumans, sans-serif);
        font-weight: bold;
        text-decoration: none;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition:
          transform 0.2s,
          background-color 0.2s;
      }
      .menu-item:hover {
        transform: translateY(-2px);
        background: #00a99d; /* splotch-teal fallback */
        background: var(--splotch-teal, #00a99d);
      }
      .menu-item:focus-visible {
        outline: 3px solid #ff003a; /* splotch-red */
        outline-offset: 2px;
      }

      /* Toggle Switch CSS */
      input:checked ~ .dot {
        transform: translateX(100%);
        background-color: #48bb78;
      }
    </style>
    <link
      href="https://fonts.googleapis.com/css2?family=Modak&family=Monofett&family=Baumans&display=swap"
      rel="stylesheet"
    />
    <script type="module" src="./src/index.js" defer></script>
    <script type="module" src="./src/mascot.js" defer></script>
    <script type="module" src="./src/a11y-improvements.js" defer></script>
    <script src="/cookie-consent.js" defer></script>
    <link rel="manifest" href="/manifest.json" />
  </head>
  <body class="bg-gray-100">
    <nav class="top-menu-bar">
      <a href="#sticker-design-box" class="menu-item">Jump to Sticker Editor</a>
      <a href="/orders.html" class="menu-item">View Order History</a>
    </nav>
    <div
      id="adblock-warning"
      style="
        display: none;
        padding: 1rem;
        background-color: #fffbe6;
        border: 1px solid #facc15;
        border-radius: 0.5rem;
        color: #713f12;
        margin: 1rem auto;
        max-width: 800px;
      "
    >
      <p style="font-weight: bold">Payment Form Blocked üõ°Ô∏è</p>
      <p>
        It looks like an ad blocker is preventing our secure payment form from
        loading. Please disable it for this site to complete your purchase.
      </p>
    </div>
    <main
      class="container mx-auto p-4 sm:p-6 lg:p-8 bg-white shadow-xl rounded-lg my-8"
    >
      <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold text-center text-gray-700">
          Custom Sticker Editor & Secure Pay
        </h1>
        <div class="flex space-x-2">
          <button
            id="sellDesignBtn"
            class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-full hidden"
          >
            Sell this Design
          </button>
        </div>
      </div>

      <!-- PeerJS Connection Status -->
      <div
        id="peerjs-status-container"
        class="mb-4 p-3 rounded-md text-sm text-white bg-gray-400"
        style="visibility: hidden; text-align: center"
      >
        PeerJS Status: Initializing...
      </div>

      <form id="payment-form">
        <!-- Sticker Design and Options Box -->
        <div
          id="sticker-design-box"
          class="p-6 rounded-lg shadow-md border border-gray-200 bg-gray-50 mb-8 outline-none"
          tabindex="-1"
        >
          <!-- UPLOAD STICKER FILE -->
          <div class="field mb-6">
            <label class="label text-sm font-medium text-gray-700" for="file"
              >Upload Sticker Design Image:</label
            >
            <div class="control">
              <input
                class="input mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"
                id="file"
                name="file"
                type="file"
                accept="image/*"
                aria-describedby="file-helper"
              />
              <span
                id="fileNameDisplay"
                class="text-sm text-gray-600 ml-2"
              ></span>
            </div>
            <p
              id="file-helper"
              class="text-xs text-gray-500 mt-1"
              style="font-family: var(--font-baumans)"
            >
              This is the main image for your sticker design.
            </p>
          </div>

          <!-- Canvas for Image Editing -->
          <div class="bg-gray-50 p-4 rounded-lg shadow-inner mb-6">
            <div class="relative w-fit mx-auto">
              <canvas
                id="imageCanvas"
                width="500"
                height="400"
                class="block border-2 border-dashed border-gray-300 rounded-md bg-white"
              >
                Your browser does not support the HTML5 canvas tag.
              </canvas>
              <div
                id="canvas-placeholder"
                class="absolute inset-0 flex flex-col items-center justify-center select-none z-20 bg-white/60 backdrop-blur-sm rounded-lg cursor-pointer hover:bg-white/80 transition-colors focus-visible:ring-4 focus-visible:ring-splotch-teal focus-visible:outline-none focus-visible:ring-inset"
                role="button"
                tabindex="0"
                aria-label="Upload an image by clicking or dragging and dropping"
              >
                <svg
                  class="w-16 h-16 mb-2 text-gray-500 pointer-events-none"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                  aria-hidden="true"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                  ></path>
                </svg>
                <p
                  class="text-lg font-medium text-gray-600 pointer-events-none"
                  style="font-family: var(--font-baumans)"
                >
                  Drag & Drop Image Here
                </p>
                <p
                  class="text-sm text-gray-500 mt-1 pointer-events-none"
                  style="font-family: var(--font-baumans)"
                >
                  or click to upload
                </p>
              </div>
              <p
                id="designMarginNote"
                class="absolute bottom-2 right-2 text-xs text-splotch-red p-1 bg-white bg-opacity-75 rounded"
                style="font-family: var(--font-baumans); display: none"
              >
                Keep important elements 2-3mm from edge!
              </p>
            </div>
          </div>

          <!-- Basic Image Editing Controls -->
          <div
            id="editing-controls"
            class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-11 xl:grid-cols-11 gap-3 my-6 p-4 border border-gray-200 rounded-md shadow-sm bg-slate-50"
          >
            <button
              type="button"
              id="rotateLeftBtn"
              title="Rotate Left 90¬∞"
              aria-label="Rotate Left"
              class="justify-self-center flex items-center justify-center"
              style="
                width: 3rem !important;
                height: 3rem !important;
                padding: 0 !important;
                border-radius: 50% !important;
              "
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="2"
                stroke="currentColor"
                class="w-6 h-6"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"
                />
              </svg>
            </button>
            <button
              type="button"
              id="resetBtn"
              title="Reset Image to Original"
              aria-label="Reset Image"
              class="justify-self-center flex flex-col items-center justify-center text-red-600 hover:text-red-800 font-medium text-xs"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-6 h-6 mb-1"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"
                />
              </svg>
              Reset
            </button>
            <button
              type="button"
              id="rotateRightBtn"
              title="Rotate Right 90¬∞"
              aria-label="Rotate Right"
              class="justify-self-center flex items-center justify-center"
              style="
                width: 3rem !important;
                height: 3rem !important;
                padding: 0 !important;
                border-radius: 50% !important;
              "
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="2"
                stroke="currentColor"
                class="w-6 h-6"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15 15l6-6m0 0l-6-6m6 6H9a6 6 0 000 12h3"
                />
              </svg>
            </button>
            <div class="flex flex-col col-span-2">
              <label for="resizeInput" class="text-sm text-center block mb-1"
                >Size:</label
              >
              <div class="flex items-center justify-center gap-1 mb-2">
                <input
                  type="number"
                  id="resizeInput"
                  class="w-20 text-center border rounded p-1 text-sm"
                  value="3.0"
                  step="0.1"
                  min="0.1"
                  aria-label="Size value"
                />
                <span id="resizeUnitLabel" class="text-sm">in</span>
              </div>
              <input
                type="range"
                id="resizeSlider"
                min="1"
                max="8"
                value="3"
                step="0.1"
                class="w-full"
                aria-label="Size slider"
              />
            </div>
            <div class="flex flex-col justify-center items-center col-span-2">
              <label class="text-xs text-gray-500 mb-1">Dimensions</label>
              <div class="flex items-center space-x-1">
                <span
                  id="widthDisplay"
                  aria-label="Calculated Width"
                  class="w-24 inline-block text-center text-xs border rounded bg-gray-50 text-gray-700 p-1"
                  >---</span
                >
                <span class="text-xs text-gray-400">x</span>
                <span
                  id="heightDisplay"
                  aria-label="Calculated Height"
                  class="w-24 inline-block text-center text-xs border rounded bg-gray-50 text-gray-700 p-1"
                  >---</span
                >
              </div>
            </div>
            <button
              type="button"
              id="grayscaleBtn"
              title="Apply Grayscale Filter"
              aria-pressed="false"
              class="lg:hidden xl:block"
            >
              Grayscale
            </button>
            <button
              type="button"
              id="sepiaBtn"
              title="Apply Sepia Filter"
              aria-pressed="false"
              class="lg:hidden xl:block"
            >
              Sepia
            </button>
            <button
              type="button"
              id="generateCutlineBtn"
              class="bg-teal-500 text-white col-span-2 sm:col-span-3 md:col-span-4 lg:col-span-4 xl:col-span-2 flex justify-center items-center gap-2"
              title="Generate Cutline from Image Alpha"
            >
              Generate Smart Cutline
            </button>
          </div>
          <div
            id="standard-sizes-controls"
            class="flex justify-center items-center space-x-2 my-4"
          >
            <span class="text-sm font-medium text-gray-700"
              >Set max dimension to:</span
            >
            <button
              type="button"
              class="size-btn"
              data-size="1"
              aria-label="Set max dimension to 1 inch"
              aria-pressed="false"
            >
              1"
            </button>
            <button
              type="button"
              class="size-btn"
              data-size="2"
              aria-label="Set max dimension to 2 inches"
              aria-pressed="false"
            >
              2"
            </button>
            <button
              type="button"
              class="size-btn"
              data-size="3"
              aria-label="Set max dimension to 3 inches"
              aria-pressed="false"
            >
              3"
            </button>
            <div class="ml-4 flex items-center">
              <span class="text-sm mr-2" aria-hidden="true">in</span>
              <label for="unitToggle" class="flex items-center cursor-pointer">
                <div class="relative">
                  <input
                    type="checkbox"
                    id="unitToggle"
                    class="sr-only peer"
                    role="switch"
                    aria-label="Use Metric Units"
                  />
                  <div
                    class="block bg-gray-600 w-14 h-8 rounded-full peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 transition-shadow"
                  ></div>
                  <div
                    class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"
                  ></div>
                </div>
              </label>
              <span class="text-sm ml-2" aria-hidden="true">mm</span>
            </div>
          </div>

          <!-- Text Editing Controls -->
          <div
            id="text-editing-controls"
            class="my-6 p-4 border border-gray-200 rounded-md shadow-sm bg-slate-100"
            hidden
          >
            <h3
              class="text-lg font-semibold text-splotch-navy mb-3"
              style="font-family: var(--font-modak)"
            >
              Add Text to Sticker
            </h3>
            <div
              class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end"
            >
              <div>
                <label
                  for="textInput"
                  class="block text-sm font-medium text-splotch-navy"
                  style="font-family: var(--font-baumans)"
                  >Text:</label
                >
                <input
                  type="text"
                  id="textInput"
                  placeholder="Your Text Here"
                  class="input mt-1 w-full"
                />
              </div>
              <div>
                <label
                  for="textSizeInput"
                  class="block text-sm font-medium text-splotch-navy"
                  style="font-family: var(--font-baumans)"
                  >Size (px):</label
                >
                <div class="flex items-center gap-2 mt-1">
                  <input
                    type="number"
                    id="textSizeInput"
                    value="30"
                    min="8"
                    max="200"
                    class="input w-20 text-center"
                  />
                  <input
                    type="range"
                    id="textSizeSlider"
                    min="8"
                    max="200"
                    value="30"
                    class="flex-grow cursor-pointer"
                    aria-label="Text size slider"
                  />
                </div>
              </div>
              <div>
                <label
                  for="textColorInput"
                  class="block text-sm font-medium text-splotch-navy"
                  style="font-family: var(--font-baumans)"
                  >Color:</label
                >
                <input
                  type="color"
                  id="textColorInput"
                  value="#2A284D"
                  class="input mt-1 h-10 w-full p-1 border-2 rounded-md cursor-pointer"
                  style="border-color: var(--splotch-navy)"
                />
              </div>
              <button
                type="button"
                id="addTextBtn"
                class="bg-splotch-red hover:brightness-110 text-white font-semibold py-2.5 px-4 rounded-full shadow-md transition duration-150 ease-in-out transform hover:scale-105 self-end"
                style="
                  font-family: var(--font-baumans);
                  text-transform: uppercase;
                "
              >
                Add Text
              </button>
            </div>
            <div class="mt-4">
              <label
                for="textFontFamily"
                class="block text-sm font-medium text-splotch-navy"
                style="font-family: var(--font-baumans)"
                >Font:</label
              >
              <select id="textFontFamily" class="input mt-1 w-full md:w-1/2">
                <option value="Arial" style="font-family: Arial, sans-serif">
                  Arial
                </option>
                <option
                  value="Verdana"
                  style="font-family: Verdana, sans-serif"
                >
                  Verdana
                </option>
                <option
                  value="Times New Roman"
                  style="font-family: &quot;Times New Roman&quot;, serif"
                >
                  Times New Roman
                </option>
                <option
                  value="Courier New"
                  style="font-family: &quot;Courier New&quot;, monospace"
                >
                  Courier New
                </option>
                <option value="Georgia" style="font-family: Georgia, serif">
                  Georgia
                </option>
                <option
                  value="Modak"
                  style="font-family: &quot;Modak&quot;, cursive"
                >
                  Modak (Display)
                </option>
                <option
                  value="Baumans"
                  style="font-family: &quot;Baumans&quot;, sans-serif"
                >
                  Baumans (Body)
                </option>
                <option
                  value="Monofett"
                  style="font-family: &quot;Monofett&quot;, cursive"
                >
                  Monofett (Display)
                </option>
              </select>
            </div>
            <p
              class="text-xs text-gray-500 mt-2"
              style="font-family: var(--font-baumans)"
            >
              Note: Text is added to the center. Advanced text positioning may
              require other tools.
            </p>
          </div>

          <!-- Sticker Options -->
          <div class="space-y-4">
            <h3
              class="text-lg font-semibold text-splotch-navy pt-2"
              style="font-family: var(--font-modak)"
            >
              Sticker Options
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="field">
                <label
                  class="label text-sm font-medium text-gray-700"
                  for="stickerQuantity"
                  >Quantity:</label
                >
                <div class="control flex items-center mt-1">
                  <button
                    type="button"
                    id="decreaseQuantityBtn"
                    class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-l-md border border-r-0 border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                    aria-label="Decrease quantity"
                  >
                    -
                  </button>
                  <input
                    class="input block w-full px-3 py-2 bg-white border border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-center z-10"
                    id="stickerQuantity"
                    name="stickerQuantity"
                    type="number"
                    value="50"
                    min="1"
                    style="border-radius: 0"
                  />
                  <button
                    type="button"
                    id="increaseQuantityBtn"
                    class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-r-md border border-l-0 border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                    aria-label="Increase quantity"
                  >
                    +
                  </button>
                </div>
              </div>
              <div class="field">
                <label
                  class="label text-sm font-medium text-gray-700"
                  for="stickerMaterial"
                  >Material:</label
                >
                <div class="control">
                  <select
                    id="stickerMaterial"
                    name="stickerMaterial"
                    class="input mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                    aria-describedby="material-helper"
                  >
                    <option value="pp_standard">Standard PP (Indoor)</option>
                    <option value="pvc_laminated">
                      Extra Durable PVC + Lamination (Outdoor 5-7 yrs)
                    </option>
                  </select>
                </div>
                <p
                  id="material-helper"
                  class="text-xs text-gray-500 mt-1"
                  style="font-family: var(--font-baumans)"
                >
                  Standard PP: Up to 1 yr outdoor. PVC: 5-7 yrs outdoor,
                  laminated.
                </p>
              </div>
              <div class="field">
                <label
                  class="label text-sm font-medium text-gray-700"
                  for="stickerResolution"
                  >Resolution:</label
                >
                <div class="control">
                  <select
                    id="stickerResolution"
                    name="stickerResolution"
                    class="input mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                    aria-describedby="resolution-helper"
                  >
                    <!-- Options will be populated by JavaScript -->
                  </select>
                </div>
                <p
                  id="resolution-helper"
                  class="text-xs text-gray-500 mt-1"
                  style="font-family: var(--font-baumans)"
                >
                  Higher DPI (Dots Per Inch) results in a sharper, higher
                  quality print.
                </p>
              </div>
            </div>
            <div class="field">
              <label
                class="label text-sm font-medium text-gray-700"
                for="cutLineFile"
                >Upload Cut Line for Custom Shape (Optional):</label
              >
              <div class="control">
                <input
                  class="input mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"
                  id="cutLineFile"
                  name="cutLineFile"
                  type="file"
                  accept=".ai,.svg,.eps,.pdf"
                  aria-describedby="cutline-helper"
                />
              </div>
              <p
                id="cutline-helper"
                class="text-xs text-gray-500 mt-1"
                style="font-family: var(--font-baumans)"
              >
                For custom shapes, please provide a vector cut line (.ai, .svg,
                .eps, .pdf). We can assist if needed (additional fee may apply).
              </p>
            </div>

            <div class="field">
              <label class="label text-sm font-medium text-gray-700"
                >Estimated Price:</label
              >
              <div
                id="calculatedPriceDisplay"
                class="mt-1 p-3 bg-white border border-gray-300 rounded-md shadow-sm text-lg font-semibold text-gray-700"
                aria-live="polite"
              >
                $0.00
              </div>
            </div>
          </div>
          <!-- End Sticker Options -->
        </div>

        <div
          id="payment-status-container"
          class="mb-4 p-3 rounded-md text-sm text-white"
          style="visibility: hidden"
          role="alert"
          aria-live="polite"
        ></div>

        <!-- Payment Status and IPFS Link Containers -->
        <div
          id="ipfsLinkContainer"
          class="mt-6 p-4 border rounded-md text-sm bg-gray-50 shadow"
          style="visibility: hidden; word-wrap: break-word"
        ></div>

        <!-- Payment Form -->
        <div class="space-y-6 bg-gray-50 p-6 rounded-lg shadow-md">
          <h2 class="text-xl font-semibold text-gray-700 mb-4 border-b pb-2">
            Order Your Custom Stickers & Pay
          </h2>

          <h3 class="text-lg font-semibold text-gray-700 mt-6 pt-4 border-t">
            Billing Information
          </h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="field">
              <label
                class="label text-sm font-medium text-gray-700"
                for="firstName"
                >First Name
                <span
                  class="text-red-500"
                  style="color: var(--splotch-red) !important"
                  aria-hidden="true"
                  >*</span
                ></label
              >
              <div class="control">
                <input
                  class="input mt-1 block w-full"
                  id="firstName"
                  name="firstName"
                  type="text"
                  placeholder="John"
                  required
                  autocomplete="given-name"
                  aria-required="true"
                />
              </div>
            </div>
            <div class="field">
              <label
                class="label text-sm font-medium text-gray-700"
                for="lastName"
                >Last Name
                <span
                  class="text-red-500"
                  style="color: var(--splotch-red) !important"
                  aria-hidden="true"
                  >*</span
                ></label
              >
              <div class="control">
                <input
                  class="input mt-1 block w-full"
                  id="lastName"
                  name="lastName"
                  type="text"
                  placeholder="Doe"
                  required
                  autocomplete="family-name"
                  aria-required="true"
                />
              </div>
            </div>
            <div class="field">
              <label class="label text-sm font-medium text-gray-700" for="email"
                >Email
                <span
                  class="text-red-500"
                  style="color: var(--splotch-red) !important"
                  aria-hidden="true"
                  >*</span
                ></label
              >
              <div class="control">
                <input
                  class="input mt-1 block w-full"
                  id="email"
                  name="email"
                  type="text"
                  placeholder="you@example.com"
                  required
                  autocomplete="email"
                  aria-required="true"
                />
              </div>
            </div>
            <div class="field">
              <label class="label text-sm font-medium text-gray-700" for="phone"
                >Phone</label
              >
              <div class="control">
                <input
                  class="input mt-1 block w-full"
                  id="phone"
                  name="phone"
                  type="tel"
                  placeholder="(123) 456-7890"
                  autocomplete="tel"
                />
              </div>
            </div>
            <div class="field md:col-span-2">
              <label
                class="label text-sm font-medium text-gray-700"
                for="address"
                >Address
                <span
                  class="text-red-500"
                  style="color: var(--splotch-red) !important"
                  aria-hidden="true"
                  >*</span
                ></label
              >
              <div class="control">
                <input
                  class="input mt-1 block w-full"
                  id="address"
                  name="address"
                  type="text"
                  placeholder="123 Main Street"
                  required
                  autocomplete="street-address"
                  aria-required="true"
                />
              </div>
            </div>
            <div class="field">
              <label class="label text-sm font-medium text-gray-700" for="city"
                >City
                <span
                  class="text-red-500"
                  style="color: var(--splotch-red) !important"
                  aria-hidden="true"
                  >*</span
                ></label
              >
              <div class="control">
                <input
                  class="input mt-1 block w-full"
                  id="city"
                  name="city"
                  type="text"
                  placeholder="Oklahoma City"
                  required
                  autocomplete="address-level2"
                  aria-required="true"
                />
              </div>
            </div>
            <div class="field">
              <label class="label text-sm font-medium text-gray-700" for="state"
                >State
                <span
                  class="text-red-500"
                  style="color: var(--splotch-red) !important"
                  aria-hidden="true"
                  >*</span
                ></label
              >
              <div class="control">
                <input
                  class="input mt-1 block w-full"
                  id="state"
                  name="state"
                  type="text"
                  placeholder="OK"
                  required
                  autocomplete="address-level1"
                  aria-required="true"
                />
              </div>
            </div>
            <div class="field">
              <label
                class="label text-sm font-medium text-gray-700"
                for="postalCode"
                >Postal Code
                <span
                  class="text-red-500"
                  style="color: var(--splotch-red) !important"
                  aria-hidden="true"
                  >*</span
                ></label
              >
              <div class="control">
                <input
                  class="input mt-1 block w-full"
                  id="postalCode"
                  name="postalCode"
                  type="text"
                  placeholder="73101"
                  required
                  autocomplete="postal-code"
                  aria-required="true"
                />
              </div>
            </div>
          </div>
          <!-- Square Card Payment Element -->
          <div
            id="card-container"
            class="p-3 border rounded-md bg-white shadow-sm min-h-[50px]"
          ></div>
          <div class="field">
            <div class="control">
              <button
                id="submitPaymentBtn"
                class="button is-primary w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-md shadow-md transition duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 disabled:opacity-75 disabled:cursor-not-allowed flex justify-center items-center gap-2"
                type="submit"
              >
                <span>Pay & Process Order</span>
              </button>
            </div>
          </div>
        </div>
        <div
          id="ipfsLinkContainer"
          class="mt-6 p-4 border rounded-md text-sm bg-gray-50 shadow"
        ></div>
      </form>

      <!-- Product Creation Modal -->
      <div
        id="productModal"
        class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 hidden"
        role="dialog"
        aria-modal="true"
        aria-labelledby="productModalTitle"
        aria-describedby="productModalDesc"
      >
        <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">
          <h2
            id="productModalTitle"
            class="text-2xl font-bold mb-4 text-gray-800"
          >
            Sell This Design
          </h2>
          <p id="productModalDesc" class="mb-4 text-gray-600">
            Create a shareable link. You earn the profit you set for every sale.
          </p>
          <div class="mb-4">
            <label
              class="block text-gray-700 text-sm font-bold mb-2"
              for="productName"
              >Product Name</label
            >
            <input
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              id="productName"
              type="text"
              placeholder="My Awesome Sticker"
            />
          </div>
          <div class="mb-6">
            <label
              class="block text-gray-700 text-sm font-bold mb-2"
              for="creatorProfit"
              >Your Profit (USD per sticker)</label
            >
            <div class="flex items-center">
              <span class="text-gray-500 mr-2">$</span>
              <input
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                id="creatorProfit"
                type="number"
                min="0"
                step="0.01"
                value="1.00"
              />
            </div>
          </div>
          <div class="flex items-center justify-between">
            <button
              id="cancelProductBtn"
              class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
            >
              Cancel
            </button>
            <button
              id="createProductBtn"
              class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
            >
              Create Link
            </button>
          </div>
          <div id="productLinkContainer" class="mt-4 hidden">
            <p class="text-sm font-bold text-green-600 mb-2">
              Success! Share this link:
            </p>
            <div class="flex">
              <input
                id="productLinkInput"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                type="text"
                readonly
              />
              <button
                id="copyLinkBtn"
                class="ml-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
              >
                Copy
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer class="bg-white shadow-md mt-8">
      <div class="container mx-auto px-6 py-3 text-center text-gray-500">
        &copy; 2025 Splotch |
        <a href="/terms.html" class="text-splotch-red hover:underline"
          >Terms & FAQ</a
        >
      </div>
    </footer>

    <div
      id="mascot-container"
      title="Hi! I'm the Splotch Mascot!"
      tabindex="0"
      role="button"
      aria-label="Interact with Splotch Mascot"
      aria-describedby="mascot-text"
    >
      <div class="speech-bubble" id="mascot-text">
        Create something awesome today!
      </div>
      <img id="mascot-img" src="/mascot.png" alt="Splotch Mascot" />
    </div>
  </body>
</html>
