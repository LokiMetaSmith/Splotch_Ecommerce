
import { createRequire } from 'module';
import { jest } from '@jest/globals';

const require = createRequire(import.meta.url);
const FormData = require('form-data');

describe('Form-Data Boundary Vulnerability', () => {
  it('should not use Math.random() for boundary generation', () => {
    const spy = jest.spyOn(Math, 'random');
    new FormData();
    // In vulnerable versions, Math.random() is called to generate the boundary.
    // In patched versions, a cryptographically secure random number generator is used.
    expect(spy).not.toHaveBeenCalled();
    spy.mockRestore();
  });
});
